(()=>{"use strict";var Ie={39472:(t,g,e)=>{e.d(g,{cQ:()=>m});const u="_cmt",m=p=>p.endsWith(u),h=p=>{if(m(p))throw new Error("bad datKey: "+p);return""+p+u},c=p=>{if(!m(p))throw new Error("bad cmtKey: "+p);return p.slice(0,-u.length)},B="_cur",P=p=>p.endsWith(B),C=p=>{if(P(p))throw new Error("bad datKey: "+p);return""+p+B},v=p=>{if(!P(p))throw new Error("bad curKey: "+p);return p.slice(0,-B.length)}},95485:(t,g,e)=>{e.d(g,{$p:()=>ce,By:()=>_e,Yo:()=>je,cN:()=>ue});var u=e(87587),m=e(35517),h=e(80966),c=e(49842),B=e(26886),P=e(74982),C=e(60074),v=e(98388),p=e(67817),I=e(43980),z=e(18890),G=e.n(z),H=e(45761),U=e.n(H),oe=e(66966),O=e.n(oe),ne=e(60264),X=e(28016),N=e(29352),de=e(53492);ENV.IS_SKT_HTTP&&(0,h.lQ)(!0),(0,C.d)(I.uT,I.n_);const ce=async(n,a)=>{console.warn("[onTransferError]",n,a),n==="Tot"||n==="5XX"?MB.notice&&MB.notice({text:I18N.Common.offline_alert,duration:32*1e3,showClose:!0,priority:1,type:"super"}):n==="4XX"&&a&&/403/.test(a.message)?MB.global.popupHelper.alertAsyncBlocked({title:I18N.dModule.cant_edit,confirmText:I18N.dModule.exit_editing,desc:I18N.dModule.cant_edit_desc}).then(()=>MB.global.onBackButtonClick()):n==="4XX"&&a&&/401/.test(a.message)?(window.onbeforeunload=void 0,MB.global.popupHelper.alertAsyncBlocked({title:I18N.dModule.err_info_modal.INVALID_COOKIE.title,desc:I18N.dModule.err_info_modal.INVALID_COOKIE.desc,confirmText:I18N.dModule.confirm}).then(()=>(0,m.av)())):n==="4XX"?(window.onbeforeunload=void 0,MB.global.popupHelper.alertAsyncBlocked({title:I18N.dModule.err_info_modal.INVALID_COOKIE.title,desc:I18N.dModule.err_info_modal.INVALID_COOKIE.desc,confirmText:I18N.dModule.confirm}).then(()=>(0,m.av)())):await MB.global.popupHelper.alertAsyncBlocked({desc:window.I18N.dModule.unknown_error.replace(/%s/i,status),isHTML:!0})},je=async(n,a)=>{console.warn("[onReadOnlyError]",n,a),n!=="Cur"&&MB.notice&&MB.notice({text:I18N.Common.offline_alert,duration:5*1e3,showClose:!0,priority:1})},Pe=n=>{let{sendCur:a,cssCur:S}=n;const y=()=>{try{if((0,c.s_)()){const A=(0,B.ef)();if(!A)return;const{container:{runner:{activePageKey:L}}}=A;if(!L)return;a(L,void 0,void 0)}else{const A=(0,B.UF)();if(!A)return;const{current:{currentScreen:L},screencontainer:{cursorPos:Y}}=A,F=L&&(L.cid||L.key);if(!F)return;const{x:$,y:re}=Y||{};a(F,$,re)}}catch(T){console.error("cssCur push error",T)}};setInterval(()=>{S.pollRoomChg()&&y()},3*1e3),document.addEventListener("pointermove",y,{passive:!0})},ue=function(n,a){var S,y,T,A,L,Y,F,$,re,me,ae;a===void 0&&(a=rootSdk);const M=(0,B.UF)();if(!(!M||!MB.action)&&!(((S=rootSdk)==null||(S=S.cssCur)==null?void 0:S.getSocketStat().length)<=1)){if((y=M.ui.leftLayout.directory.screen.contextMenuState)!=null&&y.show&&U()(M.ui.leftLayout.directory.screen.contextMenuState.contextScreenSelection,n).length>0){const j=O()(M.ui.leftLayout.directory.screen.contextMenuState.contextScreenSelection,n);j.length===0&&MB.action("screen:close:contextmenu"),MB.action("screen:update:contextmenu:contextScreenSelection",j),MB.action("screen:update:screen-selection",{screenSelection:j})}if(M.ui.leftLayout.directory.screen.currentPage&&n.includes(M.ui.leftLayout.directory.screen.currentPage.key)&&((T=a.sdkStore.getHotItem(M.ui.leftLayout.directory.screen.currentPage.key))==null?void 0:T.sup)==="B@trash"&&(M.editor.state.mode.basketEditor.key&&MB.action("entry:exit:edit:basket"),M.editor.state.mode.basketEditor.refPage?MB.action("entry:update:screen:list"):MB.action("entry:activate:root-project:home-screen"),MB.notice({text:"\u5F53\u524D\u9009\u4E2D\u753B\u5E03\u5DF2\u88AB\u6B63\u5728\u534F\u540C\u7684\u6210\u5458\u5220\u9664",type:"warning"})),M.editor.state.mode.basketEditor.key&&a.sdkStore.isTrashed(M.editor.state.mode.basketEditor.key)&&(MB.action("entry:exit:edit:basket"),MB.notice({text:"\u5F53\u524D\u7F16\u8F91\u52A8\u6001\u7EC4\u4EF6\u5DF2\u88AB\u6B63\u5728\u534F\u540C\u7684\u6210\u5458\u5220\u9664",type:"warning"})),M.editor.state.mode.basketEditor.key&&n[0]){const j=a.sdkStore.getHotItem(n[0]);if((j==null?void 0:j.sup)==="@@T"){var he;if((j==null||(he=j.hotAttr)==null?void 0:he.type)==="rResCanvas"){var ie;const D=a.sdkStore.getHotItem(M.editor.state.mode.basketEditor.key);if(n[1]&&D&&((ie=D.hotAttr)==null?void 0:ie.refRBPageKey)===n[1]){const R=a.sdkStore.findAllTypeUnder(n[1],"rResCanvas");(R==null?void 0:R.length)===0&&(MB.action("entry:exit:edit:basket"),n[0]&&a.sdkStore.deleteHotItem(n[0]))}}}else M.editor.state.mode.basketEditor.key===n[0]&&MB.action("mode:update:basketEditor:hotItem",j)}if(M.editor.state.mode.basketEditor.refPage&&n.includes(M.editor.state.mode.basketEditor.refPage)){var ge;if(((ge=a.sdkStore.getHotItem(M.editor.state.mode.basketEditor.refPage))==null?void 0:ge.sup)==="@@T"){var ye;if(MB.action("entry:exit:edit:basket"),MB.notice({text:"\u5F53\u524D\u7F16\u8F91\u6BCD\u7248\u5DF2\u88AB\u6B63\u5728\u534F\u540C\u7684\u6210\u5458\u5220\u9664",type:"warning"}),((ye=a.sdkStore.getSubHotItemList(M.editor.state.mode.basketEditor.refPage))==null?void 0:ye.length)===0){const j=a.sdkStore.findAllBasketFRBPage(M.editor.state.mode.basketEditor.refPage);a.sdkStore.deleteHotItemBatch([...j.map(D=>D.key),M.editor.state.mode.basketEditor.refPage])}}else M.editor.state.mode.basketEditor.refPage===n[0]&&MB.action("mode:update:basketEditor:hotItem",a.sdkStore.getHotItem(n[0]))}if(((A=a.sdkStore.getHotItem(n[0]))==null?void 0:A.hotAttr.type)==="rResBunch"&&((L=a.sdkStore.getHotItem(n[0]))==null?void 0:L.hotAttr.bunch)==="rbPage")if(!M.ui.leftLayout.directory.screen.screenDataMap[n])MB.action("entry:update:screen:list");else{const j=M.ui.leftLayout.directory.screen.screenDataMap[n],D=a.sdkStore.getHotItem(n[0]);if(D&&!G()(D==null?void 0:D.hotAttr,j==null?void 0:j.hotAttr)){var ve,Me;(j==null||(ve=j.hotAttr)==null?void 0:ve.name)!==(D==null||(Me=D.hotAttr)==null?void 0:Me.name)&&MB.action("entry:update:screen:list");const R=M==null?void 0:M.ui.leftLayout.directory.screen.currentPage;(R==null?void 0:R.key)===(D==null?void 0:D.key)&&MB.action("entry:update:current:screen-mata",{screenMeta:{cid:D==null?void 0:D.key,sup:D==null?void 0:D.sup,sub:D==null?void 0:D.sub,...D==null?void 0:D.hotAttr},updateWidgetTreeData:!1})}}if((Y=M.editor.state.table)!=null&&Y.selectTableCellInfo&&n[0]===((F=M.editor.state.table)==null||(F=F.widget)==null?void 0:F.key)&&(($=a.sdkStore.getHotItem(n[0]))==null?void 0:$.hotAttr.type)==="wTable")if(a.sdkStore.isTrashed(n[0]))MB.action("entry:clear:selection"),MB.action("table:update:info",{selectTableCellInfo:null,isShowTableMenu:!1,widget:null,isEditTable:!1}),MB.f.isEditTable=!1;else{var we,se;const{selectionLeftTopInfo:{x:j,y:D},selectionRightBottomInfo:{x:R,y:V}}=(we=M.editor.state.table)==null?void 0:we.selectTableCellInfo,Q=a.sdkStore.getHotItem(n[0]);if(Q!=null&&(se=Q.hotAttr)!=null&&se.tableData){const{hotAttr:{tableData:{columns:q,rows:ee}}}=Q;let be=j,Se=D,Ee=R,Be=V;j>q.length-1&&(be=q.length-1),R>q.length-1&&(Ee=q.length-1),D>ee.length-1&&(Se=ee.length-1),V>ee.length-1&&(Be=ee.length-1);const De={...M.editor.state.table.widget,...Q.hotAttr};(0,X.G)({widget:De,x1:be,y1:Se,x2:Ee,y2:Be})}}(re=M.editor.state.mind)!=null&&re.editMindKey&&n.includes((me=M.editor.state.mind)==null?void 0:me.editMindKey)&&a.sdkStore.isTrashed((ae=M.editor.state.mind)==null?void 0:ae.editMindKey)&&MB.action("mind:exit:edit:state"),MB.action("entry:rebuild:screen-widget-tree"),MB.action("entry:refresh:link-list")}},pe=(0,u.P2)(n=>{ue(n),fe(n.map(a=>sdkStore.getHotItem(a)).filter(a=>{var S;return(a==null||(S=a.hotAttr)==null?void 0:S.type)==="wChart"}))},.5*1e3),ke={repaint:n=>{let{type:a,payload:S}=n;a===P.K&&pe(S)}},Ce=(0,u.P2)(()=>{!(0,B.UF)()||!MB.action||MB.action("entry:comment:rebuild:commentList")},.5*1e3),Te={repaint:n=>{let{type:a,payload:S}=n;a===ne.K&&Ce()}},xe=async n=>{let{projectBasicCid:a}=n;try{const{userId:S,flatKey:y}=await fetchGetJSON("/api/flat/web_v1/proj2-edit-info?prj2Cid="+a);return{userId:S,flatKey:y}}catch(S){await apiErrorModals(S)}},_e=async(n,a)=>{try{const y=await(0,h.od)(n),T=y.sdkStore.createRoSdkStore();Object.assign(globalThis,{...y,rootSdk:y,roSdkStore:T}),Pe(y),y.sdkStore.subscribe(ke.repaint),y.cmtStore.subscribe(Te.repaint),a&&(0,c.mK)()&&((0,N.yR)(y.flatStore,a),(0,N.qQ)(y.flatStore),(0,N.vZ)(y.flatStore,a)),await de.S.Map100000.loadMLG(),fe(y.sdkStore.findAllTypeUnder("B@main","wChart"))}catch(y){var S;const T=y?Number(y.status)||Number((S=y.toString().split("status")[1])==null||(S=S.split(":")[1])==null?void 0:S.split(",")[0])||401:void 0;console.warn("[initRootSdk]",y,T),(0,C.Q)("initRootSdk",y,{status:T,sdkOption:n,projectBasic:a}),await(0,m.Vz)({status:T}),await new Promise(()=>{})}},fe=async n=>{for(const a of n){const{chartType:S,mapAdCode:y}=a.hotAttr.chartConfig;if(S==="map_chart"){const T=de.S["Map"+y];T.hasMLG()||await T.loadMLG()}}},Re=n=>async a=>{let{fssDat:S}=a;try{const y=await S.loadSOS();if(!y)return;console.warn("[afterStoreCreate] found unsaved proj tree",y);const T=await MB.global.popupHelper.confirmAsync({isClose:!0,isHTML:!0,title:"\u6062\u590D\u6570\u636E",desc:["<p>\u68C0\u6D4B\u5230\u672A\u6210\u529F\u4FDD\u5B58\u5230\u4E91\u7AEF\u7684\u6587\u4EF6\u6570\u636E\uFF0C\u6700\u540E\u8BB0\u5F55\u65F6\u95F4\u4E3A\uFF1A"+getFormatDateString(new Date(y.time).getTime(),"","-")+"\u3002</p>","<p>\u662F\u5426\u6062\u590D\u6570\u636E\u5230\u65B0\u6587\u4EF6\uFF1F</p>"].join(""),confirmText:"\u6062\u590D",cancelText:"\u53D6\u6D88"});if(toSentry("loadSOS",void 0,{isKeep:!!T,time:y.time}),T){const{clientData:{upperCid:A}}=await newFlpakFromTree(y.tree,n.team_cid,{...n,name:n.name+"-\u6062\u590D\u6570\u636E"});await S.freeSOS(),location.href="/proto/design/"+A}else await S.freeSOS()}catch(y){console.warn("[afterStoreCreate]",y)}}},4091:(t,g,e)=>{e.d(g,{S3:()=>m,kC:()=>B,ky:()=>c,pX:()=>u});const u="/proto",m=v=>u+"/"+v,h=v=>{const p=/^\/proto\/design\/(?:([^/]+?))$/i.exec(v);return p?p[1]:new Error("project cid error")},c=v=>{let{search:p,pathname:I}=v;return I.includes("/sharing")?I.includes("dashboard")||I.includes("htmlzip")?I.split("/").at(-3):I.includes("embed/v2")?location.pathname.split("/").at(-4):I.split("/").at(-2):new URLSearchParams(p).get("token")||/^\/proto\/([^/]+?)(?:\/forum|\/uichina|\/embed|\/embed\/v2|\/htmlzip|\/sharing|\/ro)?\/?$/i.exec(I)[1]},B="/p2mkt_view",P=v=>B+"/"+v,C=v=>/^\/p2mkt_view\/(?:([^/]+?))$/i.exec(v)[1]},95891:(t,g,e)=>{var u=e(46198),m=e(75112),h=e(39110),c=e(21202);const B={"sk-bouncedelay":"ZdD58bXGNcNoQjiPeXLu"},P={"sk-bouncedelay":"ZBrU7Yes6CevGkk6hArA"};e(34268),e(87645),e(3012);var C=e(49650),v=e(7485),p=e(29402),I=e(13062),z=e(79552),G=e(90869),H=e(68205),U=e(68035),oe=e(444),O=e(35269);class ne extends v.PureComponent{constructor(o){super(o);const{store:l,projectBasic:f,projectMeta:d,isHtmlZip:w}=o,E=new URLSearchParams(location.search);let r="",i="";E.get("view_mode")==="read_only"&&(r=E.get("screen")||"",i=E.get("canvasId")||""),this.state={visibleIsEmpty:!1};try{const _=(0,oe.FZ)(r);l.dispatch({type:"entry:root-project:readOnly:activate",payload:{projectBasic:f,projectMeta:d,screenCid:_,canvasCid:i,isHtmlZip:w}})}catch(_){this.state={visibleIsEmpty:!0}}}componentDidMount(){this.props.onComponentDidMount()}render(){const{store:o}=this.props;return this.state.visibleIsEmpty?(0,U.L)():(0,O.jsx)(z.zt,{store:o,children:(0,O.jsx)(H.Z,{children:(0,O.jsx)(G.Z,{})})})}}var X=e(95485);const N=async b=>{let{projectMetaCid:o}=b;await(0,X.By)({userId:void 0,flpakKey:o,onTransferError:X.$p,onReadOnlyError:X.Yo,isDummyCmt:!0,__fetchFlpakAsync:m.Ev},void 0)};var de=e(58509);const ce=function(b,o,l){const f=o.getGuidesData()||"[]",d=new Set(JSON.parse(f)),w=new Set,E=new Map;return{checkGuideHasShown:r=>d.has(r),checkGuideToBeShown:r=>w.has(r),getState:()=>({commonGuidesHasShown:Array.from(d),commonGuidesToBeShown:Array.from(w),mountGuidesMap:E}),tryToShowGuide:r=>{var i;if(d.has(r)||!((i=MB)!=null&&(i=i.user)!=null&&i.id))return;const _=document.getElementById("MD_"+r);if(_){_.style.display="block";return}w.add(r),(0,de.k)(r,b,l)},markGuideAsRead:r=>{d.add(r),o.setGuidesData(JSON.stringify(Array.from(d)))},batchMarkGuideAsRead:r=>{r.forEach(i=>d.add(i)),o.setGuidesData(JSON.stringify(Array.from(d)))},closeGuide:r=>{const i=document.getElementById("MD_"+r);i&&i.parentNode&&i.parentNode.removeChild(i)},closeAllGuide:()=>{const r=document.getElementById("GUIDES");r&&r.parentNode&&r.parentNode.removeChild(r)},removeGuide:r=>{d.delete(r),o.setGuidesData(JSON.stringify(Array.from(d)))},tryToContinueMountGuide:(r,i)=>{const _=E.get(r);_&&typeof(_==null?void 0:_.handleContinue)=="function"&&_.handleContinue(i)},tryToResizeMountGuide:r=>{const i=E.get(r);i&&typeof(i==null?void 0:i.handleResize)=="function"&&i.handleResize()},tryToCloseMountGuide:r=>{const i=E.get(r);i&&typeof(i==null?void 0:i.handleClose)=="function"&&i.handleClose()},registerMountGuideCallback:(r,i)=>{const _=E.get(r)||{};E.set(r,{..._,...i})},removeMountGuideCallback:(r,i)=>{if(!i){E.delete(r);return}const _=E.get(r)||{};E.set(r,{..._,[i]:void 0})},reSetHasShownGuides:r=>{d.clear(),r.forEach(i=>d.add(i)),o.setGuidesData(JSON.stringify(Array.from(d)))}}},je=b=>{let{store:o,commonGuidesData:l,isDesign:f,isPreview:d}=b;MB.commonGuideHelper=ce(o,{getGuidesData:()=>l,setGuidesData:updateUserCommonGuidesData},{isDesign:f,isPreview:d})},Pe=b=>{let{store:o,isDesign:l,isPreview:f}=b;const d={guide:{dashboard_guides:"",workspace_guides:"",square_guides:null,workspace_guides_version:"",default_team_cid:"",root_project_team_cid:"",workspace_guides_2203:"",workspace_guides_2203_version:"",aboard_guides:""},guide_project_template_cid:"",guide_project_template_2203_cid:"",guide_flow_template_cid:"",guide_design_template_cid:"",guide_prototype_template_cid:""},{guide:{workspace_guides:w}}=d;MB.commonGuideHelper=ce(o,{getGuidesData:()=>w,setGuidesData:()=>{}},{isDesign:l,isPreview:f})};var ue=e(84649),pe=e(90863),ke=e(16426),Ce=e(98388),Te=e(3172),xe=e(29184),_e=e(11230);const fe=b=>{let{initialData:o,designOptions:l,global:f,onUpdateSharing:d}=b;const{user:w,org:E,team:r,preference:i,orgList:_,user_fcg:k,org_fcg:x,space:K,canEditByCurrentUser:J}=o,{currentUser:W,currentOrg:Z}=(0,_e.t)({user:w,org:E});(0,Ce.PX)((0,xe.F)()),Object.assign(MB,{user:W||{},currentOrg:Z,canEditByCurrentUser:J,global:{...f,popupHelper:(0,pe.A)(),experienceLoginModalHelper:ue.m}}),MB.action("current:update:state",{currentOrg:Z,currentTeam:r,currentUser:W,orgList:_,user_fcg:k,org_fcg:x,currentSpace:K}),MB.action("update:design:options",{designOptions:l}),w!=null&&w.id&&MB.action("entry:init:preference",{preference:i}),d&&d()},Re=async b=>{let{designStore:o}=b,l="[]";try{const{guide:f}=await requestUserCommonGuidesData();l=f==null?void 0:f.workspace_guides}catch(f){console.error("\u83B7\u53D6 guide_data \u5931\u8D25")}await initCommonGuide({store:o,commonGuidesData:l,isDesign:!0,isPreview:!1})},n=async b=>{let{type:o,projectBasicCid:l}=b;switch(o){case DesignType.Design:return requestProjectFullDataFlat(l);case DesignType.Experience:return requestExperienceFullDataFlat(l);default:throw new Error(o+" not found in known design types for "+l)}};var a=e(47573),S=e(60698),y=e(22567),T=e(47933),A=e(68543);const L=b=>{const{isEmbedV1:o=!1}=b||{};return{isDesktop:!((0,A.tq)()||o),isInApp:!1,isMultiLink:!1,isMobile:(0,A.tq)(),isIOSClient:(0,A.B0)(),isStandAlone:(0,A.IF)(),isEmbedV1:o,isEmbedV2:!1,isHTMLZip:!1,isUIChina:(0,A.Md)(),isForum:(0,A._j)(),isElectron:(0,A.d)(),isSquare:!1,isFeishu:(0,A.Rv)(),isWechat:(0,A.CL)(),...b}},Y=b=>{const{isMobile:o,isEmbedV2:l,isSquare:f}=b;return o?y.Z:l||f?S.Z:T.Z},F=b=>{let{designOptions:o,previewOptions:l,initialData:f,onComponentDidMount:d,sharing:w}=b,E=!1;const r=(0,I.t)(MB);fe({initialData:f,designOptions:o,global:{designOptions:o,previewOptions:l}});const{isIOSClient:i,isStandAlone:_}=l;(_||i)&&(document.documentElement.style.height="100vh");const{runnerController:k,messageBucket:x,webpackInterface:K,PreviewApp:J}=(0,a.o)(Y(l));return Object.assign(MB,{runnerController:k,messageBucket:x,webpackInterface:K,global:{...MB.global||{},popupHelper:(0,pe.A)(),designOptions:o,previewOptions:l}}),MB.webpackInterface.store.dispatch({type:"preview:update:state",payload:{previewOptions:l}}),{requestData:async()=>{const{user:W,org:Z,preference:le,project_basic:te,project_meta:Le}=f;return Pe({store:r,isDesign:!0,isPreview:!1}),Object.assign(MB,{tag:te==null?void 0:te.version}),MB.action("update:design:options",{designOptions:MB.global.designOptions}),await N({projectMetaCid:Le.cid}),MB.webpackInterface.store.dispatch({type:"preview:set:current-projectShare",payload:{projectShare:w}}),MB.webpackInterface.store.dispatch({type:"entry:init:preview:preference",payload:{preference:le||{}}}),Object.assign(MB,{user:W||{},canEditByCurrentUser:!1,org:Z||void 0}),MB.webpackInterface.store.dispatch({type:"entry:state:init"}),E=!0,{projectAlike:te,projectMeta:Le,projectShare:w}},renderDesign:W=>{let{projectAlike:Z,projectMeta:le}=W;return E?(0,O.jsx)(ne,{store:r,projectBasic:Z,projectMeta:le,onComponentDidMount:d,isHtmlZip:!0}):null},renderPreview:W=>{let{projectAlike:Z,projectMeta:le,projectShare:te}=W;return E?((0,U.K)(te),(0,O.jsx)(J,{store:K.store,previewMode:"preview",projectAlike:Z,projectMeta:le,projectShare:te})):null}}};var $=e(45090);const re=$.ZP.div.withConfig({displayName:"styles__StyledExampleApp",componentId:"sc-1e7mzg5-0"})(["&{position:absolute;top:0;left:0;bottom:0;right:0;transition:all 0.2s ease-in-out;.loading-container{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);.mb-loading{width:80px;height:80px;}.chris-icon{position:absolute;left:68%;top:-8%;}}}.mb-design-page{&,#mb-toolbar{transition:all 0.2s ease-in-out;}&.is-collapse{opacity:0;#mb-toolbar{transform:translateY(-100%);}.mb-right-panel{transform:translateX(100%);}}}.mb-preview-page{position:absolute;top:0;left:0;width:100%;bottom:0;font-size:12px;transition:all 0.2s ease-in-out;&.is-collapse{opacity:0;}}"]),me=$.ZP.div.withConfig({displayName:"styles__StyledROExampleApp",componentId:"sc-1e7mzg5-1"})(["&{position:absolute;top:0;left:0;bottom:0;right:0;transition:all 0.2s ease-in-out;.loading-container{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);.mb-loading{width:80px;height:80px;}.chris-icon{position:absolute;left:68%;top:-8%;}}}.mb-design-page{&.is-collapse{opacity:0;}}.mb-preview-page{position:absolute;top:0;left:0;width:100%;bottom:0;font-size:12px;&.is-collapse{opacity:0;}}"]);var ae=e(85322),M=e(24011),he=e(34595),ie=e.n(he);class ge extends v.PureComponent{render(){const{isCollapse:o,renderReadOnly:l,projectAlike:f,projectMeta:d}=this.props;return(0,O.jsx)("div",{ref:w=>this.$element=w,className:ie()("mb-design-page",{"is-collapse":o}),children:l({projectAlike:f,projectMeta:d})})}}class ye extends v.PureComponent{constructor(o){super(o),(0,C.Z)(this,"setElementRef",l=>this.$element=l),MB.f.inPreview=!o.isCollapse}componentDidMount(){this.$element.addEventListener("wheel",this.handleWheel,{passive:!1})}componentWillUnmount(){MB.f.inPreview=!1,this.$element.removeEventListener("wheel",this.handleWheel)}handleWheel(o){(o.ctrlKey||o.metaKey)&&o.preventDefault()}render(){const{isCollapse:o,renderPreview:l,projectAlike:f,projectMeta:d,projectShare:w}=this.props;return(0,O.jsx)("div",{ref:this.setElementRef,className:ie()("mb-preview-page",{"is-collapse":o}),children:l({projectAlike:f,projectMeta:d,projectShare:w})})}}var ve=e(69410),Me=e(5844),we=e(98142),se=e(92408),j=e(51924),D=e(84581),R=e(2074),V=e(67957);const Q=b=>{const{current:{currentProject:o},ui:{toolbar:{isShowSticky:l},leftLayout:{leftPanel:{show:f,width:d},directory:{screen:{currentPage:w},bottom:{height:E},screen:{screenCollapseKeySet:r}}},rightLayout:{rightPanel:{show:i,resizedWidth:_}}},editor:{state:{mode:{fullScreenMode:k}}}}=MB.__store__.getState(),{pageKey:x,canvasKey:K}=D.Z.validateAndTryCorrectPGAndCVKey(w.key,b,null,o.category===R.yr);MB.webpackInterface.store.dispatch({type:"entry:runner:activate:canvas",payload:{pageKey:x,canvasKey:K,saveHistory:!1,forceInit:!0}}),MB.webpackInterface.store.dispatch({type:"preview:set:leftPaneWidth",payload:{leftPaneWidth:d!=null?d:250}}),MB.webpackInterface.store.dispatch({type:"preview:update:state",payload:{hasChangedScaleManually:!1}}),MB.webpackInterface.store.dispatch({type:"entry:auto-fit:preview:scale"}),MB.webpackInterface.store.dispatch({type:"preview:set:canvas:offset:dev",payload:{offset:{x:0,y:0}}}),MB.webpackInterface.store.dispatch({type:"preview:panel:set:height",payload:{panelHeight:E}}),MB.webpackInterface.store.dispatch({type:"preview:set:rightPaneWidth",payload:{rightPaneWidth:_,projectCid:o.cid}}),k&&MB.webpackInterface.store.dispatch({type:"reducer:preview-toolbar:fullscreen",payload:{isFullScreenMode:!0}}),MB.webpackInterface.store.dispatch({type:"ST:update",payload:{STMode:l}}),MB.webpackInterface.store.dispatch({type:"entry:preview-setting:toggle:isMinimized",payload:{isMinimized:!f,isMemorize:!k}}),MB.webpackInterface.store.dispatch({type:"entry:preview-setting:toggle:rightPane",payload:{isShowRightPane:i,isMemorize:!k}}),MB.webpackInterface.store.dispatch({type:"preview:set:collapsedRBPageKeySet",payload:{collapsedRBPageKeySet:r}}),MB.action("modal:reset:state"),MB.action("entry:exit:edit:basket"),MB.__store__.dispatch({type:"entry:comment:disabled",payload:{noWigglingCommentCid:!0}}),MB.__store__.dispatch(V.Jj.toggleInspectMode(!1)),MB.__store__.dispatch(V.Jj.toggleHandMode(!1)),MB.__store__.dispatch(V.Jj.select([])),MB.__store__.dispatch({type:"elbow:update",payload:{isInElbowMode:!1}}),MB.__store__.dispatch({type:"entry:ST:STMode:disable"}),MB.__store__.dispatch({type:"ST:clear"})},q=(b,o)=>{const{container:{current:{rootProject:l},common:{leftPaneWidth:f,panelHeight:d,rightPaneWidth:w,collapsedRBPageKeySet:E},runner:{activePageKey:r},previewSetting:{isFullScreenMode:i,isMinimized:_,isShowRightPane:k}},ST:{STMode:x}}=MB.webpackInterface.store.getState(),{ui:{leftLayout:{directory:{screen:{currentPage:K}}}},editor:{state:{mode:{isHtmlZipPreview:J}}}}=MB.__store__.getState();K.key!==r?MB.__store__.dispatch({type:"entry:root-project:readOnly:activate",payload:{projectBasic:b,projectMeta:o,screenCid:r,isHtmlZip:J}}):(MB.__store__.dispatch({type:"entry:reset:design:scale"}),MB.__store__.dispatch({type:"entry:reset:canvas:offset"})),MB.__store__.dispatch({type:"screen:add:collapseKeySet",payload:{refs:E,projectCid:l.cid}}),i&&MB.__store__.dispatch(V.Jj.toggleFullScreenMode(!0)),MB.webpackInterface.store.dispatch({type:"entry:runner:cleanup:audio"}),MB.webpackInterface.store.dispatch({type:"runner:reset:state:except:history"}),MB.webpackInterface.store.dispatch({type:"container:comment:reset:state"}),MB.webpackInterface.store.dispatch({type:"preview:previewPanel:navindex",payload:{previewPanelNavIndex:0}}),MB.__store__.dispatch({type:"left-panel:set:width",payload:{width:f,projectCid:l.cid}}),MB.__store__.dispatch({type:"directory-panel:bottom:set:height",payload:{height:d}}),MB.__store__.dispatch({type:"right-side-panel:update:resize:width",payload:{width:w,projectCid:l.cid}}),MB.__store__.dispatch({type:"right-side-panel:collapse:panel",payload:{show:k,isMemorize:!i}}),MB.__store__.dispatch({type:"left-panel:collapse:panel:show",payload:{show:!_,isMemorize:!i}}),MB.__store__.dispatch({type:"entry:observe:dom:size:update-viewport-rect"}),MB.__store__.dispatch({type:"entry:isShowSticky:toggle",payload:{isShowSticky:x}}),requestAnimationFrame(()=>MB.__store__.dispatch({type:"entry:update:viewport:rect"})),MB.webpackInterface.store.dispatch({type:"entry:comment:disabled"})};class ee extends v.PureComponent{constructor(o){super(o),(0,C.Z)(this,"handleWheelChanged",k=>{if(k.deltaX===0)return;const x=document.getElementById("workspace"),K=x.scrollLeft+x.offsetWidth===x.scrollWidth&&k.deltaX>0,J=x.scrollLeft===0&&k.deltaX<0;(K||J)&&k.preventDefault()}),(0,C.Z)(this,"handleDesignDidMount",()=>{MB.reduxEntry.setEntryMap(ve.T),this.setState({isLoading:!1})}),(0,C.Z)(this,"keyboardManager",new ae.Sm);const{viewMode:l,designOptions:f,previewOptions:d,initialData:w,sharing:E}=o;MB.switchToPreview=k=>{this.state.viewMode!=="device"&&((0,se.$s)("device"),Q(k),this.setState({viewMode:"device"}))},MB.switchToReadOnly=()=>{if(this.state.viewMode==="read_only")return;const{projectAlike:k,projectMeta:x}=this.state;(0,se.$s)("read_only"),q(k,x),this.setState({viewMode:"read_only"})},this.state={isLoading:!0,isDataLoaded:!1,viewMode:l,projectAlike:null,projectMeta:null,projectShare:void 0};const{requestData:r,renderDesign:i,renderPreview:_}=F({initialData:w,designOptions:f,previewOptions:d,onComponentDidMount:this.handleDesignDidMount,sharing:E});this.requestData=r,this.renderDesign=i,this.renderPreview=_}componentDidMount(){Promise.all([this.requestData()]).then(o=>{let[{projectAlike:l,projectMeta:f,projectShare:d}]=o;this.setState({projectAlike:l,projectMeta:f,projectShare:d},()=>{this.setState({isDataLoaded:!0})});const w=document.getElementById("workspace");w&&w.addEventListener("wheel",this.handleWheelChanged)})}componentWillUnmount(){const o=document.getElementById("workspace");o&&o.removeEventListener("wheel",this.handleWheelChanged,{capture:!0})}render(){const{isLoading:o,isDataLoaded:l,viewMode:f,projectAlike:d,projectMeta:w,projectShare:E}=this.state,{renderDesign:r,renderPreview:i}=this;return(0,O.jsx)(j.M.Provider,{value:f,children:(0,O.jsx)(ae.XC.Provider,{value:this.keyboardManager,children:(0,O.jsx)(M.Z,{children:(0,O.jsxs)(me,{className:"example-app",children:[l&&(0,O.jsx)(ge,{isCollapse:f!=="read_only",projectAlike:d,projectMeta:w,renderReadOnly:r}),l&&(0,O.jsx)(ye,{isCollapse:f!=="device",projectAlike:d,projectMeta:w,projectShare:E,renderPreview:i}),o&&(0,O.jsxs)("div",{className:"loading-container",children:[(0,O.jsx)(p.S6,{className:"mb-loading"}),(0,we.T)()&&(0,O.jsx)(Me.s,{className:"chris-icon"})]})]})})})})}}var be=e(38483),Se=e(49373),Ee=e(89719),Be=e(89500);e.p="./mb-proto2/";const De=document.getElementById("workspace"),Ke=async()=>{var b,o;const l=L({isHTMLZip:!0});(0,A.tq)()&&((b=document.querySelector("body"))==null||b.classList.add("mobile"));let f=await(0,m.vn)();const{projectUpper:d,projectMeta:w}=f;f={...f,projectName:d.name,project_basic:d,project_meta:w};const{sharing:E}=await(0,Ee.ec)({project:d}),{generateLang:r}=await Be.Ar.loadLLG();await r(),document.title=""+(0,Se.FQ)(d.name||d.title),!ENV.IS_ON_PREMISES&&(0,be.wb)();const i=(o=new URLSearchParams(location.search))==null?void 0:o.get("view_mode"),_=window.HZv5_PREVIEW_MODE||"",k=i?i==="device":_==="device",x={isDesign:!0,isExperience:!1,isLoggedExperience:!1};u.render((0,O.jsx)(ee,{initialData:f,viewMode:k?"device":"read_only",designOptions:x,previewOptions:l,sharing:E}),De)};document.addEventListener("DOMContentLoaded",async()=>{await Ke()})},68543:(t,g,e)=>{e.d(g,{B0:()=>H,CL:()=>B,Dt:()=>I,ED:()=>h,G6:()=>v,IF:()=>U,Md:()=>oe,Rv:()=>c,V5:()=>m,_j:()=>O,d:()=>u,i7:()=>P,jU:()=>X,li:()=>ne,tq:()=>p,vU:()=>C});const u=()=>window.MB_DESKTOP_VERSION||window.isElectron||/Electron/i.test(navigator.userAgent),m=()=>/(Macintosh)/i.test(navigator.userAgent),h=()=>/(Windows)/i.test(navigator.userAgent),c=()=>/(Lark)/i.test(navigator.userAgent),B=()=>/MicroMessenger/i.test(navigator.userAgent),P=()=>/Chrome/i.test(navigator.userAgent),C=()=>/Firefox/i.test(navigator.userAgent),v=()=>/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent),p=()=>{const N=new URLSearchParams(location.search);return N&&N.get("inapp")==="1"&&(e.g.isInAPP=!0),/(iPod|iPhone|iPad|Android|MobileClient)/.test(navigator.userAgent)||window.isInAPP},I=()=>/Android/i.test(navigator.userAgent),z=()=>/(iPad)/.test(navigator.userAgent),G=()=>/(iPod|iPhone|iPad)/.test(navigator.userAgent),H=()=>!!(window.webkit&&window.webkit.messageHandlers),U=()=>navigator.standalone,oe=()=>/\/uichina$/.test(location.pathname),O=()=>/\/forum$/.test(location.pathname),ne=()=>/(MobileClient)/.test(navigator.userAgent),X=!!(typeof window<"u"&&window.document&&window.document.createElement)},84515:t=>{t.exports=canvg},26504:t=>{t.exports=dompurify},75177:t=>{t.exports=html2canvas}},Oe={};function s(t){var g=Oe[t];if(g!==void 0)return g.exports;var e=Oe[t]={id:t,loaded:!1,exports:{}};return Ie[t].call(e.exports,e,e.exports,s),e.loaded=!0,e.exports}s.m=Ie,s.amdO={},(()=>{var t=[];s.O=(g,e,u,m)=>{if(e){m=m||0;for(var h=t.length;h>0&&t[h-1][2]>m;h--)t[h]=t[h-1];t[h]=[e,u,m];return}for(var c=1/0,h=0;h<t.length;h++){for(var[e,u,m]=t[h],B=!0,P=0;P<e.length;P++)(m&!1||c>=m)&&Object.keys(s.O).every(G=>s.O[G](e[P]))?e.splice(P--,1):(B=!1,m<c&&(c=m));if(B){t.splice(h--,1);var C=u();C!==void 0&&(g=C)}}return g}})(),s.n=t=>{var g=t&&t.__esModule?()=>t.default:()=>t;return s.d(g,{a:g}),g},(()=>{var t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,g;s.t=function(e,u){if(u&1&&(e=this(e)),u&8||typeof e=="object"&&e&&(u&4&&e.__esModule||u&16&&typeof e.then=="function"))return e;var m=Object.create(null);s.r(m);var h={};g=g||[null,t({}),t([]),t(t)];for(var c=u&2&&e;typeof c=="object"&&!~g.indexOf(c);c=t(c))Object.getOwnPropertyNames(c).forEach(B=>h[B]=()=>e[B]);return h.default=()=>e,s.d(m,h),m}})(),s.d=(t,g)=>{for(var e in g)s.o(g,e)&&!s.o(t,e)&&Object.defineProperty(t,e,{enumerable:!0,get:g[e]})},s.f={},s.e=t=>Promise.all(Object.keys(s.f).reduce((g,e)=>(s.f[e](t,g),g),[])),s.u=t=>""+{126:"lazy-lib-i18n",147:"lazy-lib-rehype",972:"lazy-lib-dl"}[t]+"-"+{126:"98fcab96e5cb9fa4ce0e",147:"c3d533fb08ce23f33ead",972:"a9a9f7566d486bc4bdcb"}[t]+".js",s.miniCssF=t=>{},s.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch(t){if(typeof window=="object")return window}}(),s.o=(t,g)=>Object.prototype.hasOwnProperty.call(t,g),(()=>{var t={},g="@mb2023/mb-proto:";s.l=(e,u,m,h)=>{if(t[e]){t[e].push(u);return}var c,B;if(m!==void 0)for(var P=document.getElementsByTagName("script"),C=0;C<P.length;C++){var v=P[C];if(v.getAttribute("src")==e||v.getAttribute("data-webpack")==g+m){c=v;break}}c||(B=!0,c=document.createElement("script"),c.charset="utf-8",c.timeout=120,s.nc&&c.setAttribute("nonce",s.nc),c.setAttribute("data-webpack",g+m),c.src=e),t[e]=[u];var p=(z,G)=>{c.onerror=c.onload=null,clearTimeout(I);var H=t[e];if(delete t[e],c.parentNode&&c.parentNode.removeChild(c),H&&H.forEach(U=>U(G)),z)return z(G)},I=setTimeout(p.bind(null,void 0,{type:"timeout",target:c}),12e4);c.onerror=p.bind(null,c.onerror),c.onload=p.bind(null,c.onload),B&&document.head.appendChild(c)}})(),s.r=t=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),s.j=96,s.p="/mb-proto2/",(()=>{var t={96:0};s.f.j=(u,m)=>{var h=s.o(t,u)?t[u]:void 0;if(h!==0)if(h)m.push(h[2]);else{var c=new Promise((v,p)=>h=t[u]=[v,p]);m.push(h[2]=c);var B=s.p+s.u(u),P=new Error,C=v=>{if(s.o(t,u)&&(h=t[u],h!==0&&(t[u]=void 0),h)){var p=v&&(v.type==="load"?"missing":v.type),I=v&&v.target&&v.target.src;P.message="Loading chunk "+u+" failed.\n("+p+": "+I+")",P.name="ChunkLoadError",P.type=p,P.request=I,h[1](P)}};s.l(B,C,"chunk-"+u,u)}},s.O.j=u=>t[u]===0;var g=(u,m)=>{var[h,c,B]=m,P,C,v=0;if(h.some(I=>t[I]!==0)){for(P in c)s.o(c,P)&&(s.m[P]=c[P]);if(B)var p=B(s)}for(u&&u(m);v<h.length;v++)C=h[v],s.o(t,C)&&t[C]&&t[C][0](),t[C]=0;return s.O(p)},e=self.webpackChunk_mb2023_mb_proto=self.webpackChunk_mb2023_mb_proto||[];e.forEach(g.bind(null,0)),e.push=g.bind(null,e.push.bind(e))})(),s.nc=void 0,s.O(void 0,[252,29,170,493],()=>s(64600));var Ae=s.O(void 0,[252,29,170,493],()=>s(95891));Ae=s.O(Ae)})();
